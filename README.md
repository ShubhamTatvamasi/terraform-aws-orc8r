# terraform-aws-orc8r

A terraform module to create an Orchestrator deployment in AWS. This module
will create the infrastructure components (EKS, RDS, Elasticsearch, etc.)
required to run the application.

Everything below this line was generated by
[`terraform-docs`](https://github.com/segmentio/terraform-docs).

## Requirements

| Name | Version |
|------|---------|
| terraform | >= 0.12 |
| aws | >= 2.6.0 |
| kubernetes | ~> 1.10.0 |
| random | ~> 2.1 |
| tls | ~> 2.1 |

## Providers

| Name | Version |
|------|---------|
| aws | >= 2.6.0 |
| tls | ~> 2.1 |

## Inputs

| Name | Description | Type | Default | Required |
|------|-------------|------|---------|:--------:|
| cluster\_name | Name for the Orchestrator EKS cluster. | `string` | `"orc8r"` | no |
| deploy\_elasticsearch | Flag to deploy AWS Elasticsearch service as the datasink for aggregated logs. | `bool` | `false` | no |
| deploy\_elasticsearch\_service\_linked\_role | Flag to deploy AWS Elasticsearch service linked role with cluster. If you've already created an ES service linked role for another cluster, you should set this to false. | `bool` | `true` | no |
| efs\_project\_name | Project name for EFS file system | `string` | `"orc8r"` | no |
| eks\_map\_roles | EKS IAM role mapping. Note that by default, the creator of the cluster will be in the system:master group. | <pre>list(<br>    object({<br>      rolearn  = string,<br>      username = string,<br>      groups   = list(string),<br>    })<br>  )</pre> | `[]` | no |
| eks\_map\_users | Additional IAM users to add to the aws-auth ConfigMap. | <pre>list(object({<br>    userarn  = string<br>    username = string<br>    groups   = list(string)<br>  }))</pre> | `[]` | no |
| eks\_worker\_additional\_policy\_arns | Additional IAM policy ARNs to attach to EKS worker nodes. | `list(string)` | `[]` | no |
| eks\_worker\_additional\_sg\_ids | Additional security group IDs to attach to EKS worker nodes. | `list(string)` | `[]` | no |
| eks\_worker\_group\_key | If specified, the worker nodes for EKS will use this EC2 keypair. | `string` | `null` | no |
| eks\_worker\_groups | Worker group configuration for EKS. Default value is 1 worker group consisting of 3 t3.large instances. | `any` | <pre>[<br>  {<br>    "asg_desired_capacity": 3,<br>    "asg_max_size": 3,<br>    "asg_min_size": 1,<br>    "autoscaling_enabled": false,<br>    "instance_type": "t3.large",<br>    "name": "wg-1"<br>  }<br>]</pre> | no |
| elasticsearch\_az\_count | AZ count for ES. | `number` | `2` | no |
| elasticsearch\_dedicated\_master\_count | Number of dedicated ES master nodes. | `number` | `null` | no |
| elasticsearch\_dedicated\_master\_enabled | Enable/disable dedicated master nodes for ES. | `bool` | `false` | no |
| elasticsearch\_dedicated\_master\_type | Instance type for ES dedicated master nodes. | `string` | `null` | no |
| elasticsearch\_domain\_name | Name for the ES domain. | `string` | `null` | no |
| elasticsearch\_domain\_tags | Extra tags for the ES domain. | `map` | `{}` | no |
| elasticsearch\_ebs\_enabled | Use EBS for ES storage. See https://aws.amazon.com/elasticsearch-service/pricing/ to check if your chosen instance types can use non-EBS storage. | `bool` | `false` | no |
| elasticsearch\_ebs\_iops | IOPS for ES EBS volumes. | `number` | `null` | no |
| elasticsearch\_ebs\_volume\_size | Size in GB to allocate for ES EBS data volumes. | `number` | `null` | no |
| elasticsearch\_ebs\_volume\_type | EBS volume type for ES data volumes. | `string` | `null` | no |
| elasticsearch\_instance\_count | Number of instances to allocate for ES domain. | `number` | `null` | no |
| elasticsearch\_instance\_type | AWS instance type for ES domain. | `string` | `null` | no |
| elasticsearch\_version | ES version for ES domain. | `string` | `"7.1"` | no |
| global\_tags | n/a | `map` | `{}` | no |
| orc8r\_db\_engine\_version | Postgres engine version for Orchestrator DB. | `string` | `"9.6.15"` | no |
| orc8r\_db\_identifier | Identifier for the RDS instance for Orchestrator. | `string` | `"orc8rdb"` | no |
| orc8r\_db\_instance\_class | RDS instance type for Orchestrator DB. | `string` | `"db.m4.large"` | no |
| orc8r\_db\_name | DB name for Orchestrator RDS instance. | `string` | `"orc8r"` | no |
| orc8r\_db\_password | Password for the Orchestrator DB. | `string` | n/a | yes |
| orc8r\_db\_storage\_gb | Capacity in GB to allocate for Orchestrator RDS instance. | `number` | `64` | no |
| orc8r\_db\_username | Username for default DB user for Orchestrator DB. | `string` | `"orc8r"` | no |
| orc8r\_domain\_name | Base domain name for AWS Route 53 hosted zone. | `string` | n/a | yes |
| region | AWS region to deploy Orchestrator components into. The chosen region must provide EKS. | `string` | n/a | yes |
| secretsmanager\_orc8r\_secret | AWS Secret Manager secret to store Orchestrator secrets. | `string` | n/a | yes |
| vpc\_cidr | CIDR block for the VPC. | `string` | `"10.10.0.0/16"` | no |
| vpc\_database\_subnets | CIDR blocks for the VPC's database subnets. | `list(string)` | <pre>[<br>  "10.10.200.0/24",<br>  "10.10.201.0/24",<br>  "10.10.202.0/24"<br>]</pre> | no |
| vpc\_extra\_tags | Tags to add to the VPC. | `map` | `{}` | no |
| vpc\_name | Name for the VPC that will contain all the Orchestrator components. | `string` | `"orc8r_vpc"` | no |
| vpc\_private\_subnets | CIDR blocks for the VPC's private subnets. | `list(string)` | <pre>[<br>  "10.10.100.0/24",<br>  "10.10.101.0/24",<br>  "10.10.102.0/24"<br>]</pre> | no |
| vpc\_public\_subnets | CIDR blocks for the VPC's public subnets. | `list(string)` | <pre>[<br>  "10.10.0.0/24",<br>  "10.10.1.0/24",<br>  "10.10.2.0/24"<br>]</pre> | no |

## Outputs

| Name | Description |
|------|-------------|
| efs\_file\_system\_id | ID of the EFS file system created for K8s persistent volumes. |
| efs\_provisioner\_role\_arn | ARN of the IAM role for the EFS provisioner. |
| eks\_cluster\_id | Cluster ID for the EKS cluster |
| eks\_config\_map\_aws\_auth | A K8s ConfigMap to allow authentication to the EKS cluster. |
| es\_endpoint | Endpoint of the ES cluster if deployed. |
| external\_dns\_role\_arn | IAM role ARN for external-dns |
| kubeconfig | kubectl config file to access the EKS cluster |
| orc8r\_db\_host | Hostname of the Orchestrator RDS instance |
| orc8r\_db\_name | Database name for Orchestrator RDS instance |
| orc8r\_db\_pass | Orchestrator DB password |
| orc8r\_db\_port | Database connection port for Orchestrator RDS instance |
| orc8r\_db\_user | Database username for Orchestrator RDS instance |
| orc8r\_domain\_name | Base domain name for Orchestrator application components. |
| route53\_nameservers | Route53 zone nameservers for external DNS configuration. |
| route53\_zone\_id | Route53 zone ID for Orchestrator domain name |
| secretsmanager\_secret\_name | Name of the Secrets Manager secret for deployment secrets |

<!-- BEGIN_TF_DOCS -->
## Requirements

The following requirements are needed by this module:

- <a name="requirement_terraform"></a> [terraform](#requirement\_terraform) (>= 0.14)

- <a name="requirement_aws"></a> [aws](#requirement\_aws) (>= 2.6.0)

- <a name="requirement_kubernetes"></a> [kubernetes](#requirement\_kubernetes) (~> 1.11.1)

- <a name="requirement_random"></a> [random](#requirement\_random) (~> 2.1)

- <a name="requirement_random"></a> [random](#requirement\_random) (~> 2.1)

- <a name="requirement_tls"></a> [tls](#requirement\_tls) (~> 2.1)

## Providers

The following providers are used by this module:

- <a name="provider_aws"></a> [aws](#provider\_aws) (>= 2.6.0)

- <a name="provider_random"></a> [random](#provider\_random) (~> 2.1 ~> 2.1)

- <a name="provider_tls"></a> [tls](#provider\_tls) (~> 2.1)

## Modules

The following Modules are called:

### <a name="module_eks"></a> [eks](#module\_eks)

Source: terraform-aws-modules/eks/aws

Version: ~> 17.0.3

### <a name="module_vpc"></a> [vpc](#module\_vpc)

Source: terraform-aws-modules/vpc/aws

Version: ~> 2.17.0

## Resources

The following resources are used by this module:

- [aws_db_event_subscription.default](https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/db_event_subscription) (resource)
- [aws_db_instance.default](https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/db_instance) (resource)
- [aws_efs_file_system.eks_pv](https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/efs_file_system) (resource)
- [aws_efs_mount_target.eks_pv_mnt](https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/efs_mount_target) (resource)
- [aws_elasticsearch_domain.es](https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/elasticsearch_domain) (resource)
- [aws_elasticsearch_domain_policy.es_management_access](https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/elasticsearch_domain_policy) (resource)
- [aws_iam_policy.cert_manager_route53_iam_policy](https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/iam_policy) (resource)
- [aws_iam_role.cert_manager_route53_iam_role](https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/iam_role) (resource)
- [aws_iam_role.efs_provisioner](https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/iam_role) (resource)
- [aws_iam_role.external_dns](https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/iam_role) (resource)
- [aws_iam_role_policy.external_dns](https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/iam_role_policy) (resource)
- [aws_iam_role_policy_attachment.efs_provisioner](https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/iam_role_policy_attachment) (resource)
- [aws_iam_service_linked_role.es](https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/iam_service_linked_role) (resource)
- [aws_key_pair.eks_workers](https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/key_pair) (resource)
- [aws_route53_zone.orc8r](https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/route53_zone) (resource)
- [aws_secretsmanager_secret.orc8r_secrets](https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/secretsmanager_secret) (resource)
- [aws_security_group.default](https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/security_group) (resource)
- [aws_sns_topic.sns_orc8r_topic](https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/sns_topic) (resource)
- [aws_sns_topic_subscription.sns_orc8r_db_subscription_email](https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/sns_topic_subscription) (resource)
- [random_id.cert_manager_route53_random_id](https://registry.terraform.io/providers/hashicorp/random/latest/docs/resources/id) (resource)
- [tls_private_key.eks_workers](https://registry.terraform.io/providers/hashicorp/tls/latest/docs/resources/private_key) (resource)
- [aws_availability_zones.available](https://registry.terraform.io/providers/hashicorp/aws/latest/docs/data-sources/availability_zones) (data source)
- [aws_eks_cluster.cluster](https://registry.terraform.io/providers/hashicorp/aws/latest/docs/data-sources/eks_cluster) (data source)
- [aws_eks_cluster_auth.cluster](https://registry.terraform.io/providers/hashicorp/aws/latest/docs/data-sources/eks_cluster_auth) (data source)
- [aws_iam_policy_document.cert_manager_route53_iam_policy_document](https://registry.terraform.io/providers/hashicorp/aws/latest/docs/data-sources/iam_policy_document) (data source)
- [aws_iam_policy_document.cert_manager_route53_iam_policy_document_assume](https://registry.terraform.io/providers/hashicorp/aws/latest/docs/data-sources/iam_policy_document) (data source)
- [aws_iam_policy_document.eks_worker_assumable](https://registry.terraform.io/providers/hashicorp/aws/latest/docs/data-sources/iam_policy_document) (data source)
- [aws_iam_policy_document.es-management](https://registry.terraform.io/providers/hashicorp/aws/latest/docs/data-sources/iam_policy_document) (data source)
- [aws_iam_policy_document.external_dns](https://registry.terraform.io/providers/hashicorp/aws/latest/docs/data-sources/iam_policy_document) (data source)

## Required Inputs

The following input variables are required:

### <a name="input_orc8r_db_password"></a> [orc8r\_db\_password](#input\_orc8r\_db\_password)

Description: Password for the Orchestrator DB. Must be at least 8 characters.

Type: `string`

### <a name="input_orc8r_domain_name"></a> [orc8r\_domain\_name](#input\_orc8r\_domain\_name)

Description: Base domain name for AWS Route 53 hosted zone.

Type: `string`

### <a name="input_region"></a> [region](#input\_region)

Description: AWS region to deploy Orchestrator components into. The chosen region must provide EKS.

Type: `string`

### <a name="input_secretsmanager_orc8r_secret"></a> [secretsmanager\_orc8r\_secret](#input\_secretsmanager\_orc8r\_secret)

Description: AWS Secret Manager secret to store Orchestrator secrets.

Type: `string`

## Optional Inputs

The following input variables are optional (have default values):

### <a name="input_blue_green_worker_groups"></a> [blue\_green\_worker\_groups](#input\_blue\_green\_worker\_groups)

Description: Worker group configuration for EKS. Default value is 1 worker group consisting of 5 t3.medium instances.

Type: `any`

Default:

```json
[
  {
    "asg_desired_capacity": 8,
    "asg_max_size": 8,
    "asg_min_size": 1,
    "autoscaling_enabled": false,
    "instance_type": "t3.medium",
    "kubelet_extra_args": "",
    "name": "wg-1"
  }
]
```

### <a name="input_cluster_name"></a> [cluster\_name](#input\_cluster\_name)

Description: Name for the Orchestrator EKS cluster.

Type: `string`

Default: `"orc8r"`

### <a name="input_cluster_version"></a> [cluster\_version](#input\_cluster\_version)

Description: Kubernetes version for the EKS cluster.

Type: `string`

Default: `"1.21"`

### <a name="input_deploy_elasticsearch"></a> [deploy\_elasticsearch](#input\_deploy\_elasticsearch)

Description: Flag to deploy AWS Elasticsearch service as the datasink for aggregated logs.

Type: `bool`

Default: `false`

### <a name="input_deploy_elasticsearch_service_linked_role"></a> [deploy\_elasticsearch\_service\_linked\_role](#input\_deploy\_elasticsearch\_service\_linked\_role)

Description: Flag to deploy AWS Elasticsearch service linked role with cluster. If you've already created an ES service linked role for another cluster, you should set this to false.

Type: `bool`

Default: `true`

### <a name="input_efs_project_name"></a> [efs\_project\_name](#input\_efs\_project\_name)

Description: Project name for EFS file system

Type: `string`

Default: `"orc8r"`

### <a name="input_eks_enable_irsa"></a> [eks\_enable\_irsa](#input\_eks\_enable\_irsa)

Description: Enable IAM Roles for Service Accounts (IRSA) on the EKS cluster.

Type: `bool`

Default: `true`

### <a name="input_eks_map_roles"></a> [eks\_map\_roles](#input\_eks\_map\_roles)

Description: EKS IAM role mapping. Note that by default, the creator of the cluster will be in the system:master group.

Type:

```hcl
list(
    object({
      rolearn  = string,
      username = string,
      groups   = list(string),
    })
  )
```

Default: `[]`

### <a name="input_eks_map_users"></a> [eks\_map\_users](#input\_eks\_map\_users)

Description: Additional IAM users to add to the aws-auth ConfigMap.

Type:

```hcl
list(object({
    userarn  = string
    username = string
    groups   = list(string)
  }))
```

Default: `[]`

### <a name="input_eks_worker_additional_policy_arns"></a> [eks\_worker\_additional\_policy\_arns](#input\_eks\_worker\_additional\_policy\_arns)

Description: Additional IAM policy ARNs to attach to EKS worker nodes.

Type: `list(string)`

Default: `[]`

### <a name="input_eks_worker_additional_sg_ids"></a> [eks\_worker\_additional\_sg\_ids](#input\_eks\_worker\_additional\_sg\_ids)

Description: Additional security group IDs to attach to EKS worker nodes.

Type: `list(string)`

Default: `[]`

### <a name="input_eks_worker_group_key"></a> [eks\_worker\_group\_key](#input\_eks\_worker\_group\_key)

Description: If specified, the worker nodes for EKS will use this EC2 keypair.

Type: `string`

Default: `null`

### <a name="input_eks_worker_groups"></a> [eks\_worker\_groups](#input\_eks\_worker\_groups)

Description: Worker group configuration for EKS. Default value is 1 worker group consisting of 3 t3.large instances.

Type: `any`

Default:

```json
[
  {
    "asg_desired_capacity": 3,
    "asg_max_size": 3,
    "asg_min_size": 1,
    "autoscaling_enabled": false,
    "instance_type": "t3.large",
    "kubelet_extra_args": "",
    "name": "wg-1"
  }
]
```

### <a name="input_elasticsearch_az_count"></a> [elasticsearch\_az\_count](#input\_elasticsearch\_az\_count)

Description: AZ count for ES.

Type: `number`

Default: `2`

### <a name="input_elasticsearch_dedicated_master_count"></a> [elasticsearch\_dedicated\_master\_count](#input\_elasticsearch\_dedicated\_master\_count)

Description: Number of dedicated ES master nodes.

Type: `number`

Default: `null`

### <a name="input_elasticsearch_dedicated_master_enabled"></a> [elasticsearch\_dedicated\_master\_enabled](#input\_elasticsearch\_dedicated\_master\_enabled)

Description: Enable/disable dedicated master nodes for ES.

Type: `bool`

Default: `false`

### <a name="input_elasticsearch_dedicated_master_type"></a> [elasticsearch\_dedicated\_master\_type](#input\_elasticsearch\_dedicated\_master\_type)

Description: Instance type for ES dedicated master nodes.

Type: `string`

Default: `null`

### <a name="input_elasticsearch_domain_name"></a> [elasticsearch\_domain\_name](#input\_elasticsearch\_domain\_name)

Description: Name for the ES domain.

Type: `string`

Default: `null`

### <a name="input_elasticsearch_domain_tags"></a> [elasticsearch\_domain\_tags](#input\_elasticsearch\_domain\_tags)

Description: Extra tags for the ES domain.

Type: `map`

Default: `{}`

### <a name="input_elasticsearch_ebs_enabled"></a> [elasticsearch\_ebs\_enabled](#input\_elasticsearch\_ebs\_enabled)

Description: Use EBS for ES storage. See https://aws.amazon.com/elasticsearch-service/pricing/ to check if your chosen instance types can use non-EBS storage.

Type: `bool`

Default: `false`

### <a name="input_elasticsearch_ebs_iops"></a> [elasticsearch\_ebs\_iops](#input\_elasticsearch\_ebs\_iops)

Description: IOPS for ES EBS volumes.

Type: `number`

Default: `null`

### <a name="input_elasticsearch_ebs_volume_size"></a> [elasticsearch\_ebs\_volume\_size](#input\_elasticsearch\_ebs\_volume\_size)

Description: Size in GB to allocate for ES EBS data volumes.

Type: `number`

Default: `null`

### <a name="input_elasticsearch_ebs_volume_type"></a> [elasticsearch\_ebs\_volume\_type](#input\_elasticsearch\_ebs\_volume\_type)

Description: EBS volume type for ES data volumes.

Type: `string`

Default: `null`

### <a name="input_elasticsearch_instance_count"></a> [elasticsearch\_instance\_count](#input\_elasticsearch\_instance\_count)

Description: Number of instances to allocate for ES domain.

Type: `number`

Default: `null`

### <a name="input_elasticsearch_instance_type"></a> [elasticsearch\_instance\_type](#input\_elasticsearch\_instance\_type)

Description: AWS instance type for ES domain.

Type: `string`

Default: `null`

### <a name="input_elasticsearch_version"></a> [elasticsearch\_version](#input\_elasticsearch\_version)

Description: ES version for ES domain.

Type: `string`

Default: `"7.1"`

### <a name="input_enable_aws_db_notifications"></a> [enable\_aws\_db\_notifications](#input\_enable\_aws\_db\_notifications)

Description: Flag to enable AWS RDS notifications

Type: `bool`

Default: `false`

### <a name="input_enable_orc8r_blue_green_deployment"></a> [enable\_orc8r\_blue\_green\_deployment](#input\_enable\_orc8r\_blue\_green\_deployment)

Description: Flag to enable the deployment for a blue & green Orc8r instances in the same infrastructure

Type: `bool`

Default: `false`

### <a name="input_global_tags"></a> [global\_tags](#input\_global\_tags)

Description: n/a

Type: `map`

Default: `{}`

### <a name="input_magma_uuid"></a> [magma\_uuid](#input\_magma\_uuid)

Description: UUID to identify Orc8r deployment

Type: `string`

Default: `"default"`

### <a name="input_orc8r_db_apply_immediately"></a> [orc8r\_db\_apply\_immediately](#input\_orc8r\_db\_apply\_immediately)

Description: Flag to immediately upgrade RDS without waiting for a maintenance window

Type: `bool`

Default: `false`

### <a name="input_orc8r_db_backup_retention"></a> [orc8r\_db\_backup\_retention](#input\_orc8r\_db\_backup\_retention)

Description: Database backup retention period

Type: `number`

Default: `7`

### <a name="input_orc8r_db_backup_window"></a> [orc8r\_db\_backup\_window](#input\_orc8r\_db\_backup\_window)

Description: Database daily backup window in UTC with a 30-minute minimum

Type: `string`

Default: `"01:00-01:30"`

### <a name="input_orc8r_db_dialect"></a> [orc8r\_db\_dialect](#input\_orc8r\_db\_dialect)

Description: Database dialect for Orchestrator DB.

Type: `string`

Default: `"postgres"`

### <a name="input_orc8r_db_engine_version"></a> [orc8r\_db\_engine\_version](#input\_orc8r\_db\_engine\_version)

Description: Postgres engine version for Orchestrator DB.

Type: `string`

Default: `"12.8"`

### <a name="input_orc8r_db_event_subscription"></a> [orc8r\_db\_event\_subscription](#input\_orc8r\_db\_event\_subscription)

Description: Database event subscription

Type: `string`

Default: `"orc8r-rds-events"`

### <a name="input_orc8r_db_identifier"></a> [orc8r\_db\_identifier](#input\_orc8r\_db\_identifier)

Description: Identifier for the RDS instance for Orchestrator.

Type: `string`

Default: `"orc8rdb"`

### <a name="input_orc8r_db_instance_class"></a> [orc8r\_db\_instance\_class](#input\_orc8r\_db\_instance\_class)

Description: RDS instance type for Orchestrator DB.

Type: `string`

Default: `"db.m4.large"`

### <a name="input_orc8r_db_name"></a> [orc8r\_db\_name](#input\_orc8r\_db\_name)

Description: DB name for Orchestrator RDS instance.

Type: `string`

Default: `"orc8r"`

### <a name="input_orc8r_db_storage_gb"></a> [orc8r\_db\_storage\_gb](#input\_orc8r\_db\_storage\_gb)

Description: Capacity in GB to allocate for Orchestrator RDS instance.

Type: `number`

Default: `64`

### <a name="input_orc8r_db_username"></a> [orc8r\_db\_username](#input\_orc8r\_db\_username)

Description: Username for default DB user for Orchestrator DB.

Type: `string`

Default: `"orc8r"`

### <a name="input_orc8r_sns_email"></a> [orc8r\_sns\_email](#input\_orc8r\_sns\_email)

Description: SNS email endpoint to send notifications

Type: `string`

Default: `""`

### <a name="input_orc8r_sns_name"></a> [orc8r\_sns\_name](#input\_orc8r\_sns\_name)

Description: SNS for Orc8r to redirect alerts and notifications

Type: `string`

Default: `"orc8r-sns"`

### <a name="input_setup_cert_manager"></a> [setup\_cert\_manager](#input\_setup\_cert\_manager)

Description: Create IAM role and policy for cert-manager.

Type: `bool`

Default: `false`

### <a name="input_thanos_enabled"></a> [thanos\_enabled](#input\_thanos\_enabled)

Description: Enable thanos infrastructure

Type: `bool`

Default: `false`

### <a name="input_thanos_worker_groups"></a> [thanos\_worker\_groups](#input\_thanos\_worker\_groups)

Description: Worker group configuration for Thanos. Default consists of 1 group consisting of 1 m5d.xlarge for thanos.

Type: `any`

Default:

```json
[
  {
    "asg_desired_capacity": 1,
    "asg_max_size": 1,
    "asg_min_size": 1,
    "autoscaling_enabled": false,
    "instance_type": "m5d.xlarge",
    "kubelet_extra_args": "--node-labels=compute-type=thanos",
    "name": "thanos-1"
  }
]
```

### <a name="input_vpc_cidr"></a> [vpc\_cidr](#input\_vpc\_cidr)

Description: CIDR block for the VPC.

Type: `string`

Default: `"10.10.0.0/16"`

### <a name="input_vpc_database_subnets"></a> [vpc\_database\_subnets](#input\_vpc\_database\_subnets)

Description: CIDR blocks for the VPC's database subnets.

Type: `list(string)`

Default:

```json
[
  "10.10.200.0/24",
  "10.10.201.0/24",
  "10.10.202.0/24"
]
```

### <a name="input_vpc_extra_tags"></a> [vpc\_extra\_tags](#input\_vpc\_extra\_tags)

Description: Tags to add to the VPC.

Type: `map`

Default: `{}`

### <a name="input_vpc_name"></a> [vpc\_name](#input\_vpc\_name)

Description: Name for the VPC that will contain all the Orchestrator components.

Type: `string`

Default: `"orc8r_vpc"`

### <a name="input_vpc_private_subnets"></a> [vpc\_private\_subnets](#input\_vpc\_private\_subnets)

Description: CIDR blocks for the VPC's private subnets.

Type: `list(string)`

Default:

```json
[
  "10.10.100.0/24",
  "10.10.101.0/24",
  "10.10.102.0/24"
]
```

### <a name="input_vpc_public_subnets"></a> [vpc\_public\_subnets](#input\_vpc\_public\_subnets)

Description: CIDR blocks for the VPC's public subnets.

Type: `list(string)`

Default:

```json
[
  "10.10.0.0/24",
  "10.10.1.0/24",
  "10.10.2.0/24"
]
```

## Outputs

The following outputs are exported:

### <a name="output_cert_manager_route53_iam_role_arn"></a> [cert\_manager\_route53\_iam\_role\_arn](#output\_cert\_manager\_route53\_iam\_role\_arn)

Description: IAM role ARN for cert-manager.

### <a name="output_efs_file_system_id"></a> [efs\_file\_system\_id](#output\_efs\_file\_system\_id)

Description: ID of the EFS file system created for K8s persistent volumes.

### <a name="output_efs_provisioner_role_arn"></a> [efs\_provisioner\_role\_arn](#output\_efs\_provisioner\_role\_arn)

Description: ARN of the IAM role for the EFS provisioner.

### <a name="output_eks_cluster_id"></a> [eks\_cluster\_id](#output\_eks\_cluster\_id)

Description: Cluster ID for the EKS cluster

### <a name="output_eks_config_map_aws_auth"></a> [eks\_config\_map\_aws\_auth](#output\_eks\_config\_map\_aws\_auth)

Description: A K8s ConfigMap to allow authentication to the EKS cluster.

### <a name="output_es_endpoint"></a> [es\_endpoint](#output\_es\_endpoint)

Description: Endpoint of the ES cluster if deployed.

### <a name="output_es_volume_size"></a> [es\_volume\_size](#output\_es\_volume\_size)

Description: Endpoint of the ES cluster if deployed.

### <a name="output_external_dns_role_arn"></a> [external\_dns\_role\_arn](#output\_external\_dns\_role\_arn)

Description: IAM role ARN for external-dns

### <a name="output_kubeconfig"></a> [kubeconfig](#output\_kubeconfig)

Description: kubectl config file to access the EKS cluster

### <a name="output_orc8r_db_dialect"></a> [orc8r\_db\_dialect](#output\_orc8r\_db\_dialect)

Description: Database dialect for Orchestrator RDS instance

### <a name="output_orc8r_db_host"></a> [orc8r\_db\_host](#output\_orc8r\_db\_host)

Description: Hostname of the Orchestrator RDS instance

### <a name="output_orc8r_db_name"></a> [orc8r\_db\_name](#output\_orc8r\_db\_name)

Description: Database name for Orchestrator RDS instance

### <a name="output_orc8r_db_pass"></a> [orc8r\_db\_pass](#output\_orc8r\_db\_pass)

Description: Orchestrator DB password

### <a name="output_orc8r_db_port"></a> [orc8r\_db\_port](#output\_orc8r\_db\_port)

Description: Database connection port for Orchestrator RDS instance

### <a name="output_orc8r_db_user"></a> [orc8r\_db\_user](#output\_orc8r\_db\_user)

Description: Database username for Orchestrator RDS instance

### <a name="output_orc8r_domain_name"></a> [orc8r\_domain\_name](#output\_orc8r\_domain\_name)

Description: Base domain name for Orchestrator application components.

### <a name="output_route53_nameservers"></a> [route53\_nameservers](#output\_route53\_nameservers)

Description: Route53 zone nameservers for external DNS configuration.

### <a name="output_route53_zone_id"></a> [route53\_zone\_id](#output\_route53\_zone\_id)

Description: Route53 zone ID for Orchestrator domain name

### <a name="output_secretsmanager_secret_name"></a> [secretsmanager\_secret\_name](#output\_secretsmanager\_secret\_name)

Description: Name of the Secrets Manager secret for deployment secrets

### <a name="output_setup_cert_manager"></a> [setup\_cert\_manager](#output\_setup\_cert\_manager)

Description: Create IAM role and policy for cert-manager.
<!-- END_TF_DOCS -->